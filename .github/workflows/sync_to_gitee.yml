name: Sync GitHub to Gitee  # 工作流名称

# 触发条件：当代码推送到 GitHub 的 main 分支时触发
on:
  push:
    branches: [ main ]  # 可修改为你的默认分支，如 master

# 工作流任务
jobs:
  sync:
    runs-on: ubuntu-latest  # 运行环境（Ubuntu 系统）
    steps:
      # 步骤1：拉取 GitHub 仓库代码
      - name: Checkout GitHub code
        uses: actions/checkout@v4  # 使用官方的代码拉取动作
        with:
          fetch-depth: 0  # 拉取所有历史记录，避免缺失提交
      
      # 步骤2：将代码同步到 Gitee
      - name: Sync to Gitee
        uses: wearerequired/git-mirror-action@v1  # 使用第三方同步动作
        env:
          # 从 GitHub Secrets 中获取私钥
          SSH_PRIVATE_KEY: ${{ secrets.yuc7_macbook }}
        with:
          # 源仓库（GitHub）地址（SSH 格式）
          source-repo: git@github.com:yc913344706/ops_arch_dashboard.git
          # 目标仓库（Gitee）地址（SSH 格式）
          destination-repo: git@gitee.com:YcVayne/ops_arch_dashboard.git