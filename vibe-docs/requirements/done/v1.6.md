# V1.6 版本需求文档

## 概述

本文档基于 V1.5 需求文档，我们主要讨论监控机制的问题与优化。

目前的监控机制为 @vibe-docs/alert_flow.md 中描述的，但是存在一些问题，比如：

1. 当前的一个node，可以填写多个主机+端口信息，称为 base_info_list，我们的监控，就是对于每一个主机，进行ping监测，对于每一个端口（若填），进行socket监测。主机+端口是可能重复的，所以，我们的监测是有可能重复的。如果要解决这个问题，我们需要对 base_info_list 做去重，但是，因为 base_info_list 是node model里面的一个jsonfield，所以，要实现这个，我们是不是还需要创建一个model，来保存这个node的base_info_list？它与Node可能是一个多对多的关系？
2. 现在对于监控的实现，是 @code/backend/apps/monitor/tasks.py 中的 shared_task check_all_nodes，它是循环进行检查的，这样我认为在主机数量多起来之后，是会越来越慢的，有没有一个更好的实现方式呢？比如我们就假设我们要满足的需求是，几千个host+port的量级，如果我想持续监控ping，和端口连通性，而且还想每分钟拿到一次结果，当前的监控方式能达到我们的需求吗？还是我们要考虑下其他方案？比如paramiko可以同时检测多个host + port吗？或者我们需要 asyncio？